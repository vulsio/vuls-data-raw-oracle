{
	"id": "oval:com.oracle.elsa:def:20219084",
	"version": "501",
	"class": "patch",
	"metadata": {
		"title": "\nELSA-2021-9084: Unbreakable Enterprise kernel security update (IMPORTANT)\n",
		"affected": {
			"family": "unix",
			"platform": [
				"Oracle Linux 7"
			]
		},
		"reference": [
			{
				"source": "elsa",
				"ref_id": "ELSA-2021-9084",
				"ref_url": "https://linux.oracle.com/errata/ELSA-2021-9084.html"
			},
			{
				"source": "CVE",
				"ref_id": "CVE-2020-16120",
				"ref_url": "https://linux.oracle.com/cve/CVE-2020-16120.html"
			},
			{
				"source": "CVE",
				"ref_id": "CVE-2021-3347",
				"ref_url": "https://linux.oracle.com/cve/CVE-2021-3347.html"
			},
			{
				"source": "CVE",
				"ref_id": "CVE-2021-3348",
				"ref_url": "https://linux.oracle.com/cve/CVE-2021-3348.html"
			}
		],
		"description": "\n[4.14.35-2047.501.1.el7uek]\n- ovl: restore creds in all return paths of ovl_iterate (Somasundaram Krishnasamy)  [Orabug: 32620381]\n\n[4.14.35-2047.501.0]\n- block/diskstats: accumulate all per-cpu counters in one pass (Konstantin Khlebnikov)  [Orabug: 32531559] \n- uek-rpm: config-aarch-embedded2 update for Jan 2021 Elba patches (Dave Kleikamp)  [Orabug: 32532588] \n- dts/pensando: Fix compatile -> compatible typeo. (David Clear)  [Orabug: 32532588] \n- Interrupt domain controllers for Elba ASIC. (David Clear)  [Orabug: 32532588] \n- elba_defconfig: CONFIG_PTP_1588_CLOCK=y (David Clear)  [Orabug: 32532588] \n- soc/pensando: pcie driver (David Clear)  [Orabug: 32532588] \n- pcie: control access to pcie clock domain registers (David Clear)  [Orabug: 32532588] \n- mmc: sdhci-cadence-elba ADMA and HS200 tuning support (David Clear)  [Orabug: 32532588] \n- enable rcu callback offloading & adaptive tick mode to reduce jitter (David Clear)  [Orabug: 32532588] \n- uek-rpm: Enable perf trace support for OL7 kernel builds. (Mridula Shastry)  [Orabug: 32528194] \n- uek-rpm: update config-aarch-embedded2 for Elba (Dave Kleikamp)  [Orabug: 32361844] \n- elba: u-boot environment partitions in the device-tree (David Clear)  [Orabug: 32361844] \n- i2c: Add Elba Ortano Lattice RD1173 I2C controller driver. (David Clear)  [Orabug: 32361844] \n- elba: one more mnet for elba.dtsi (David Clear)  [Orabug: 32361844] \n- elba: Add IPv6 support to elba_defconfig (David Clear)  [Orabug: 32361844] \n- mmc: sdhci-cadence-elba sdhci driver cleanup (David Clear)  [Orabug: 32361844] \n- spi-dw: custom chip-select handler for elba (David Clear)  [Orabug: 32361844] \n- arch/arm64: Pensando elba dts and config files (David Clear)  [Orabug: 32361844] \n- drivers/soc/pensando: crash dump driver. (David Clear)  [Orabug: 32361844] \n- drivers/pensando/soc: Boot State Machine (BSM) integration. (David Clear)  [Orabug: 32361844] \n- drivers/soc/pensando: /dev/capmem driver. (David Clear)  [Orabug: 32361844] \n- drivers/mmc/host: Pensando Elba support in the Cadence EMMC host controller (David Clear)  [Orabug: 32361844] \n- drivers/gpio: support the Elba SPI chip-selects. (David Clear)  [Orabug: 32361844] \n- arch/arm64: Pensando Elba SoC declaration. (David Clear)  [Orabug: 32361844] \n- mmc: sdhci-cadence: fix PHY write (Vladimir Kondratiev)  [Orabug: 32361844] \n- mmc: sdhci-cadence: set SDHCI_QUIRK2_PRESET_VALUE_BROKEN for UniPhier (Masahiro Yamada)  [Orabug: 32361844] \n- mmc: sdhci-cadence: remove unneeded 'inline' marker (Masahiro Yamada)  [Orabug: 32361844] \n- mmc: sdhci-cadence: use struct_size() helper (Gustavo A. R. Silva)  [Orabug: 32361844] \n- mmc: sdhci-cadence: fix logically and structurally dead code (Gustavo A. R. Silva)  [Orabug: 32361844] \n- mmc: sdhci-cadence: send tune request twice to work around errata (Masahiro Yamada)  [Orabug: 32361844] \n- mmc: sdhci-cadence: use bitfield access macros for cleanup (Masahiro Yamada)  [Orabug: 32361844] \n- Revert 'Support the reset pulse width from the device-tree.' (Dave Kleikamp)  [Orabug: 32361844] \n- Revert 'Initial Pensando Capri SoC declaration' (Dave Kleikamp)  [Orabug: 32361844] \n- Revert 'Add Capri EMMC phy and instantiate the driver in the dts' (Dave Kleikamp)  [Orabug: 32361844] \n- Revert 'Capri SPI driver' (Dave Kleikamp)  [Orabug: 32361844] \n- Revert 'Interrupt domain controllers for Capri ASIC.' (Dave Kleikamp)  [Orabug: 32361844] \n- Revert 'Add uio support for Capri PCIE and Link interrupts' (Dave Kleikamp)  [Orabug: 32361844] \n- Revert 'Pensando/Capri PCIE panic handler.' (Dave Kleikamp)  [Orabug: 32361844] \n- Revert 'Pensando crash dump driver' (Dave Kleikamp)  [Orabug: 32361844] \n- Revert 'Pensando Boot State Machine (BSM) integration.' (Dave Kleikamp)  [Orabug: 32361844] \n- Revert 'Add mnic nodes to the Pensando devicetree' (Dave Kleikamp)  [Orabug: 32361844] \n- Revert 'mtd/spi-nor/cadence-quadspi.c: Speed up reads.' (Dave Kleikamp)  [Orabug: 32361844] \n- Revert 'Add /proc/xmaps' (Dave Kleikamp)  [Orabug: 32361844] \n- Revert 'Add Pensando Capri board .dts files and default configs' (Dave Kleikamp)  [Orabug: 32361844] \n- Revert 'Provide for precise control of pgprot for Pensando' (Dave Kleikamp)  [Orabug: 32361844] \n- Revert 'Kconfig option to disable outer-cache-allocate for Pensando' (Dave Kleikamp)  [Orabug: 32361844] \n- Revert 'Add /dev/capmem driver for Pensando' (Dave Kleikamp)  [Orabug: 32361844] \n- Revert 'Make low-speed APB bus accesses single threaded' (Dave Kleikamp)  [Orabug: 32361844] \n- sched/topology: Assert non-NUMA topology masks don't (partially) overlap (Valentin Schneider)  [Orabug: 32485794] \n- x86/msr: Add a pointer to an URL which contains further details (Borislav Petkov)  [Orabug: 32409137] \n- x86/msr: Downgrade unrecognized MSR message (Borislav Petkov)  [Orabug: 32409137] \n- x86/msr: Do not allow writes to MSR_IA32_ENERGY_PERF_BIAS (Borislav Petkov)  [Orabug: 32409137] \n- x86/msr: Prevent userspace MSR access from dominating the console (Chris Down)  [Orabug: 32409137] \n- x86/msr: Filter MSR writes (Borislav Petkov)  [Orabug: 32409137] \n- tools/power/x86_energy_perf_policy: Read energy_perf_bias from sysfs (Borislav Petkov)  [Orabug: 32409137] \n- tools/power/turbostat: Read energy_perf_bias from sysfs (Borislav Petkov)  [Orabug: 32409137] \n- tools/power/cpupower: Read energy_perf_bias from sysfs (Borislav Petkov)  [Orabug: 32409137] \n- uek-rpm: Enable Oracle Pilot BMC module (Eric Snowberg)  [Orabug: 32422664] \n- hwmon: Add a new Oracle Pilot BMC driver (Eric Snowberg)  [Orabug: 32422664] \n- ovl: verify permissions in ovl_path_open() (Miklos Szeredi)  [Orabug: 32435220]  {CVE-2020-16120}\n- ovl: switch to mounter creds in readdir (Miklos Szeredi)  [Orabug: 32435220]  {CVE-2020-16120}\n- ovl: pass correct flags for opening real directory (Miklos Szeredi)  [Orabug: 32435220] \n- l2tp: fix race in pppol2tp_release with session object destroy (James Chapman)  [Orabug: 32435324] \n- l2tp: fix races with tunnel socket close (James Chapman)  [Orabug: 32435324] \n- l2tp: don't use inet_shutdown on ppp session destroy (James Chapman)  [Orabug: 32435324] \n- l2tp: don't use inet_shutdown on tunnel destroy (James Chapman)  [Orabug: 32435324] \n- l2tp: exit_net cleanup check added (Vasily Averin)  [Orabug: 32435324] \n- l2tp: remove the .tunnel_sock field from struct pppol2tp_session (Guillaume Nault)  [Orabug: 32435324] \n- l2tp: avoid using ->tunnel_sock for getting session's parent tunnel (Guillaume Nault)  [Orabug: 32435324] \n- l2tp: remove .tunnel_sock from struct l2tp_eth (Guillaume Nault)  [Orabug: 32435324] \n- l2tp: don't close sessions in l2tp_tunnel_destruct() (Guillaume Nault)  [Orabug: 32435324] \n- l2tp: remove field 'dev' from struct l2tp_eth (Guillaume Nault)  [Orabug: 32435324] \n- l2tp: remove l2tp_tunnel_count and l2tp_session_count (Guillaume Nault)  [Orabug: 32435324] \n- l2tp: remove ->ref() and ->deref() (Guillaume Nault)  [Orabug: 32435324] \n- net: l2tp: mark expected switch fall-through (Gustavo A. R. Silva)  [Orabug: 32435324] \n- l2tp: initialise PPP sessions before registering them (Guillaume Nault)  [Orabug: 32435324] \n- rds: CONFIG_RDS_DEBUG + tracepoints breaks rds build (Alan Maguire)  [Orabug: 32442506] \n- futex: Handle faults correctly for PI futexes (Thomas Gleixner)  [Orabug: 32447189]  {CVE-2021-3347}\n- futex: Simplify fixup_pi_state_owner() (Thomas Gleixner)  [Orabug: 32447189]  {CVE-2021-3347}\n- futex: Use pi_state_update_owner() in put_pi_state() (Thomas Gleixner)  [Orabug: 32447189]  {CVE-2021-3347}\n- rtmutex: Remove unused argument from rt_mutex_proxy_unlock() (Thomas Gleixner)  [Orabug: 32447189]  {CVE-2021-3347}\n- futex: Provide and use pi_state_update_owner() (Thomas Gleixner)  [Orabug: 32447189]  {CVE-2021-3347}\n- futex: Replace pointless printk in fixup_owner() (Thomas Gleixner)  [Orabug: 32447189]  {CVE-2021-3347}\n- futex: Ensure the correct return value from futex_lock_pi() (Thomas Gleixner)  [Orabug: 32447189]  {CVE-2021-3347}\n- futex: Don't enable IRQs unconditionally in put_pi_state() (Dan Carpenter)  [Orabug: 32447189]  {CVE-2021-3347}\n- nbd: freeze the queue while we're adding connections (Josef Bacik)  [Orabug: 32447287]  {CVE-2021-3348}\n- rds: avoid crash on IB conn path shutdown prepare (Alan Maguire)  [Orabug: 32457375] \n- net/rds: WARNING in rds_conn_drop (Ka-Cheong Poon)  [Orabug: 32481707] \n- rds: tracepoints incorrectly reporting valid rds ping as drop (Alan Maguire)  [Orabug: 32490010] \n- rds: tracepoint-related KASAN: use-after-free Read in rds_send_xmit (Alan Maguire)  [Orabug: 32490032] \n- selinux: allow reading labels before policy is loaded (Jonathan Lebon)  [Orabug: 32492279] \n- selinux: allow labeling before policy is loaded (Jonathan Lebon)  [Orabug: 32492279]\n",
		"advisory": {
			"severity": "IMPORTANT",
			"rights": "Copyright 2021 Oracle, Inc.",
			"issued": {
				"date": "2021-03-12"
			},
			"cve": [
				{
					"text": "CVE-2020-16120",
					"href": "https://linux.oracle.com/cve/CVE-2020-16120.html"
				},
				{
					"text": "CVE-2021-3347",
					"href": "https://linux.oracle.com/cve/CVE-2021-3347.html"
				},
				{
					"text": "CVE-2021-3348",
					"href": "https://linux.oracle.com/cve/CVE-2021-3348.html"
				}
			]
		}
	},
	"criteria": {
		"operator": "AND",
		"criterias": [
			{
				"operator": "OR",
				"criterias": [
					{
						"operator": "AND",
						"criterias": [
							{
								"operator": "OR",
								"criterias": [
									{
										"operator": "AND",
										"criterions": [
											{
												"test_ref": "oval:com.oracle.elsa:tst:20219084003",
												"comment": "kernel-uek is earlier than 0:4.14.35-2047.501.1.el7uek"
											},
											{
												"test_ref": "oval:com.oracle.elsa:tst:20219084004",
												"comment": "kernel-uek is signed with the Oracle Linux 7 key"
											}
										]
									},
									{
										"operator": "AND",
										"criterions": [
											{
												"test_ref": "oval:com.oracle.elsa:tst:20219084005",
												"comment": "kernel-uek-debug is earlier than 0:4.14.35-2047.501.1.el7uek"
											},
											{
												"test_ref": "oval:com.oracle.elsa:tst:20219084006",
												"comment": "kernel-uek-debug is signed with the Oracle Linux 7 key"
											}
										]
									},
									{
										"operator": "AND",
										"criterions": [
											{
												"test_ref": "oval:com.oracle.elsa:tst:20219084007",
												"comment": "kernel-uek-debug-devel is earlier than 0:4.14.35-2047.501.1.el7uek"
											},
											{
												"test_ref": "oval:com.oracle.elsa:tst:20219084008",
												"comment": "kernel-uek-debug-devel is signed with the Oracle Linux 7 key"
											}
										]
									},
									{
										"operator": "AND",
										"criterions": [
											{
												"test_ref": "oval:com.oracle.elsa:tst:20219084009",
												"comment": "kernel-uek-devel is earlier than 0:4.14.35-2047.501.1.el7uek"
											},
											{
												"test_ref": "oval:com.oracle.elsa:tst:20219084010",
												"comment": "kernel-uek-devel is signed with the Oracle Linux 7 key"
											}
										]
									},
									{
										"operator": "AND",
										"criterions": [
											{
												"test_ref": "oval:com.oracle.elsa:tst:20219084011",
												"comment": "kernel-uek-headers is earlier than 0:4.14.35-2047.501.1.el7uek"
											},
											{
												"test_ref": "oval:com.oracle.elsa:tst:20219084012",
												"comment": "kernel-uek-headers is signed with the Oracle Linux 7 key"
											}
										]
									},
									{
										"operator": "AND",
										"criterions": [
											{
												"test_ref": "oval:com.oracle.elsa:tst:20219084013",
												"comment": "kernel-uek-tools is earlier than 0:4.14.35-2047.501.1.el7uek"
											},
											{
												"test_ref": "oval:com.oracle.elsa:tst:20219084014",
												"comment": "kernel-uek-tools is signed with the Oracle Linux 7 key"
											}
										]
									},
									{
										"operator": "AND",
										"criterions": [
											{
												"test_ref": "oval:com.oracle.elsa:tst:20219084015",
												"comment": "kernel-uek-tools-libs is earlier than 0:4.14.35-2047.501.1.el7uek"
											},
											{
												"test_ref": "oval:com.oracle.elsa:tst:20219084016",
												"comment": "kernel-uek-tools-libs is signed with the Oracle Linux 7 key"
											}
										]
									},
									{
										"operator": "AND",
										"criterions": [
											{
												"test_ref": "oval:com.oracle.elsa:tst:20219084017",
												"comment": "kernel-uek-tools-libs-devel is earlier than 0:4.14.35-2047.501.1.el7uek"
											},
											{
												"test_ref": "oval:com.oracle.elsa:tst:20219084018",
												"comment": "kernel-uek-tools-libs-devel is signed with the Oracle Linux 7 key"
											}
										]
									},
									{
										"operator": "AND",
										"criterions": [
											{
												"test_ref": "oval:com.oracle.elsa:tst:20219084019",
												"comment": "perf is earlier than 0:4.14.35-2047.501.1.el7uek"
											},
											{
												"test_ref": "oval:com.oracle.elsa:tst:20219084020",
												"comment": "perf is signed with the Oracle Linux 7 key"
											}
										]
									},
									{
										"operator": "AND",
										"criterions": [
											{
												"test_ref": "oval:com.oracle.elsa:tst:20219084021",
												"comment": "python-perf is earlier than 0:4.14.35-2047.501.1.el7uek"
											},
											{
												"test_ref": "oval:com.oracle.elsa:tst:20219084022",
												"comment": "python-perf is signed with the Oracle Linux 7 key"
											}
										]
									}
								]
							}
						],
						"criterions": [
							{
								"test_ref": "oval:com.oracle.elsa:tst:20219084002",
								"comment": "Oracle Linux arch is aarch64"
							}
						]
					},
					{
						"operator": "AND",
						"criterias": [
							{
								"operator": "OR",
								"criterias": [
									{
										"operator": "AND",
										"criterions": [
											{
												"test_ref": "oval:com.oracle.elsa:tst:20219084003",
												"comment": "kernel-uek is earlier than 0:4.14.35-2047.501.1.el7uek"
											},
											{
												"test_ref": "oval:com.oracle.elsa:tst:20219084004",
												"comment": "kernel-uek is signed with the Oracle Linux 7 key"
											}
										]
									},
									{
										"operator": "AND",
										"criterions": [
											{
												"test_ref": "oval:com.oracle.elsa:tst:20219084005",
												"comment": "kernel-uek-debug is earlier than 0:4.14.35-2047.501.1.el7uek"
											},
											{
												"test_ref": "oval:com.oracle.elsa:tst:20219084006",
												"comment": "kernel-uek-debug is signed with the Oracle Linux 7 key"
											}
										]
									},
									{
										"operator": "AND",
										"criterions": [
											{
												"test_ref": "oval:com.oracle.elsa:tst:20219084007",
												"comment": "kernel-uek-debug-devel is earlier than 0:4.14.35-2047.501.1.el7uek"
											},
											{
												"test_ref": "oval:com.oracle.elsa:tst:20219084008",
												"comment": "kernel-uek-debug-devel is signed with the Oracle Linux 7 key"
											}
										]
									},
									{
										"operator": "AND",
										"criterions": [
											{
												"test_ref": "oval:com.oracle.elsa:tst:20219084009",
												"comment": "kernel-uek-devel is earlier than 0:4.14.35-2047.501.1.el7uek"
											},
											{
												"test_ref": "oval:com.oracle.elsa:tst:20219084010",
												"comment": "kernel-uek-devel is signed with the Oracle Linux 7 key"
											}
										]
									},
									{
										"operator": "AND",
										"criterions": [
											{
												"test_ref": "oval:com.oracle.elsa:tst:20219084024",
												"comment": "kernel-uek-doc is earlier than 0:4.14.35-2047.501.1.el7uek"
											},
											{
												"test_ref": "oval:com.oracle.elsa:tst:20219084025",
												"comment": "kernel-uek-doc is signed with the Oracle Linux 7 key"
											}
										]
									},
									{
										"operator": "AND",
										"criterions": [
											{
												"test_ref": "oval:com.oracle.elsa:tst:20219084013",
												"comment": "kernel-uek-tools is earlier than 0:4.14.35-2047.501.1.el7uek"
											},
											{
												"test_ref": "oval:com.oracle.elsa:tst:20219084014",
												"comment": "kernel-uek-tools is signed with the Oracle Linux 7 key"
											}
										]
									}
								]
							}
						],
						"criterions": [
							{
								"test_ref": "oval:com.oracle.elsa:tst:20219084023",
								"comment": "Oracle Linux arch is x86_64"
							}
						]
					}
				]
			}
		],
		"criterions": [
			{
				"test_ref": "oval:com.oracle.elsa:tst:20219084001",
				"comment": "Oracle Linux 7 is installed"
			}
		]
	}
}
