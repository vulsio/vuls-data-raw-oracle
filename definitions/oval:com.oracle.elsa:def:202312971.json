{
	"id": "oval:com.oracle.elsa:def:202312971",
	"version": "501",
	"class": "patch",
	"metadata": {
		"title": "\nELSA-2023-12971: dnsmasq security update (IMPORTANT)\n",
		"affected": {
			"family": "unix",
			"platform": [
				"Oracle Linux 7"
			]
		},
		"reference": [
			{
				"source": "elsa",
				"ref_id": "ELSA-2023-12971",
				"ref_url": "https://linux-qa.oracle.com/errata/ELSA-2023-12971.html"
			},
			{
				"source": "CVE",
				"ref_id": "CVE-2020-25681",
				"ref_url": "https://linux-qa.oracle.com/cve/CVE-2020-25681.html"
			},
			{
				"source": "CVE",
				"ref_id": "CVE-2020-25682",
				"ref_url": "https://linux-qa.oracle.com/cve/CVE-2020-25682.html"
			}
		],
		"description": "\n[2.76-17.0.3.3]\n- Fixed heap-based buffer overflow in sort_rrset (CVE-2020-25681) [Orabug: 35904921]\n- Fixed buffer overflow in extract_name() (CVE-2020-25682) [Orabug: 35904921]\n\n[2.76-17.0.1.3]\n- Prevent use after free in dhcp6_no_relay (CVE-2022-0934) [Orabug: 34775167]\n\n[2.76-17.3]\n- Accept replies from bound sockets again (#1923913)\n\n[2.76-17.2]\n- Correct two regressions introduced by CVE fixes (#1923913)\n\n[2.76-17.1]\n- Fix occasional failures in netlink on many interfaces (#1887649)\n\n[2.76-16.1]\n- Accept responses only on correct sockets (CVE-2020-25684)\n- Use strong verification on queries (CVE-2020-25685)\n- Handle multiple identical DNS queries better (CVE-2020-25686)\n- Link against nettle for sha256 hash implementation\n\n[2.76-16]\n- Fix strict-mode retries on REFUSED (#1755610)\n\n[2.76-15]\n- Forward non-recursive queries to upstream, but serve local names (#1755610)\n\n[2.76-14]\n- Stop treating SERVFAIL as successful response (#1815080)\n\n[2.76-13]\n- Do not ignore DHCPv6 relay messages (#1757247)\n\n[2.76-12]\n- Fix memory leak in create_helper (#1795369)\n\n[2.76-11]\n- Send dhcp_release even for addresses not on local network (#1752569)\n\n[2.76-10]\n- Fix TCP queries after interface recreation (#1721668)\n\n[2.79-9]\n- Fix passing of dnssec enabled queries (#1638703)\n\n[2.76-8]\n- Stop using privileged port for outbound queries (#1614331)\n\n[2.76-7]\n- Resolves: #1474515 dhcp-agent dnsmasq max files\n\n[2.76-6]\n- Small correction of CVE-2017-14491\n\n[2.76-5]\n- Fix CVE-2017-14491\n- Fix CVE-2017-14492\n- Fix CVE-2017-14493\n- Fix CVE-2017-14494\n- Fix CVE-2017-14496\n- Fix CVE-2017-14495\n- extra fixes\n\n[2.76-4]\n- Fix possible stack corruption on 32-bit architectures (#1188259)\n\n[2.76-3]\n- Log output of dhcp-script (#1188259)\n- Log format errors in dhcp-script init\n\n[2.76-2]\n- Fix a few coverity warnings\n- package is dual-licensed GPL v2 or v3\n- don't include /etc/dnsmasq.d in triplicate, ignore RPM backup files instead\n\n[2.76-1]\n- Rebase to 2.76 (#1375527)\n- Include also dhcp_release6 (#1375569)\n- Fix compilation warnings\n- Correct manual about interface aliases, warn if used without --bind*\n\n[2.66-21]\n- Related: #1367772 - fix dns server update\n\n[2.66-20]\n- Related: #1367772 - additional upstream patch\n\n[2.66-19]\n- Resolves: #1367772 - dns not updated after sleep and resume laptop\n\n* Fri Aug 26 2016 root - 2.66-18\n- Resolves: #1358427 - dhcp errors with hostnames beginning with numbers\n\n[2.66-17]\n- Resolves: #1275626 - modify the patch using new information\n\n[2.66-16]\n- Resolves: #1275626 - use the patch\n\n[2.66-15]\n- Resolves: #1275626 - dnsmasq crash with coredump on infiniband network with\n  OpenStack\n\n[2.66-14]\n- Resolves: #1232677 - handle IPv4 and IPv6 host entries properly\n\n[2.66-13]\n- Resolves: #1179756 - dnsmasq does not support MAC address based matching for\n  IPv6\n\n[2.66-12]\n- Mass rebuild 2014-01-24\n\n[2.66-11]\n- Mass rebuild 2013-12-27\n\n[2.66-10]\n- Use SO_REUSEPORT and SO_REUSEADDR if possible for DHCPv4/6 (#981973)\n\n[2.66-9]\n- Don't use SO_REUSEPORT on DHCPv4 socket to prevent conflicts with ISC DHCP (#981973)\n\n[2.66-8]\n- Fix crash when specified empty DHCP option\n\n[2.66-7]\n- use _hardened_build macro instead of hardcoded flags\n- include several fixies from upstream repo:\n  - Allow constructed ranges from interface address at end of range\n  - Dont BINDTODEVICE DHCP socket if more interfaces may come\n  - Fix option parsing for dhcp host\n  - Log forwarding table overflows\n  - Remove limit in prefix length in auth zone\n\n[2.66-6]\n- include several fixies from upstream repo:\n  - Tighten hostname checks in legal hostname() function\n  - Replace inet_addr() with inet_pton() in src/option.c\n  - Use dnsmasq as default DNS server for RA only if it's doing DNS\n  - Handle IPv4 interface address labels (aliases) in Linux (#962246)\n  - Fix failure to start with ENOTSOCK (#962874)\n\n[2.66-5]\n- dnsmasq unit file cleanup\n  - drop forking Type and PIDfile and rather start dnsmasq with '-k' option\n  - drop After syslog.target as this is by default\n\n[2.66-4]\n- include several fixes from upstream repo:\n  - Send TCP DNS messages in one packet\n  - Fix crash on SERVFAIL when using --conntrack option\n  - Fix regression in dhcp_lease_time utility\n  - Man page typos fixes\n  - Note that dhcp_lease_time and dhcp_release work only for IPv4\n  - Fix for --dhcp-match option to work also with BOOTP protocol\n\n[2.66-3]\n- Use Full RELRO when linking the daemon\n- compile the daemon with PIE\n- include two fixes from upstream git repo\n\n[2.66-2]\n- New stable version dnsmasq-2.66\n- Drop of merged patch\n\n[2.66-1.rc5]\n- Update to latest dnsmasq-2.66rc5\n- Include fix for segfault when lease limit is reached\n\n[2.66-1.rc1]\n- Update to latest dnsmasq-2.66rc1\n- Dropping unneeded patches\n- Enable IDN support\n\n[2.65-5]\n- Allocate dhcp_buff-ers also if daemon->ra_contexts to prevent SIGSEGV (#920300)\n\n[2.65-4]\n- Handle locally-routed DNS Queries (#904940)\n\n[2.65-3]\n- build dnsmasq with ,  explicitly (#903362)\n\n[2.65-2]\n- Fix for CVE-2013-0198 (checking of TCP connection interfaces) (#901555)\n\n[2.65-1]\n- new version 2.65\n\n[2.64-1]\n- New version 2.64\n- Merged patches dropped\n\n[2.63-4]\n- Remove EnvironmentFile from service file (#878343)\n\n[2.63-3]\n- dhcp6 support fixes (#867054)\n- removed '-s uln-cp-update-1' from .service file (#753656, #822797)\n\n[2.63-2]\n- Introduce new systemd-rpm macros in dnsmasq spec file (#850096)\n\n[2.63-1]\n- Use .tar.gz compression, in upstream site there is no .lzma anymore\n- New version 2.63\n\n[2.59-5]\n- Compile DHCP lease management utils with RPM_OPT_FLAGS\n\n[2.59-4]\n- Include DHCP lease management utils in a subpackage\n\n[2.59-3]\n- Rebuilt for https://fedoraproject.org/wiki/Fedora_17_Mass_Rebuild\n\n[2.59-2]\n- do not enable service by default\n\n[2.59-1]\n- New version 2.59\n- Fix regression in 2.58 (IPv6 issue) - bz 744814\n\n[2.58-1]\n- Fixed License\n- New version 2.58\n\n[2.52-5]\n- Include systemd unit file\n\n[2.52-3]\n- Applied Johann's patch, minor cleanup\n\n[2.52-3]\n- Introduce systemd unit file, drop SysV support\n\n[2.52-2]\n- Rebuilt for https://fedoraproject.org/wiki/Fedora_15_Mass_Rebuild\n\n[2.52-1]\n- New Version 2.52\n- fix condrestart() in initscript bz 547605\n- fix sed to enable DBUS(the '*' need some escaping) bz 553161\n\n[2.51-2]\n- fix bz 512664\n\n[2.51-1]\n- move initscript from patch to a plain text file\n- drop (dnsmasq-configuration.patch) and use sed instead\n- enable /etc/dnsmasq.d fix bz 526703\n- change requires to package name instead of file\n- new version 2.51\n\n[2.48-4]\n- Fix multiple TFTP server vulnerabilities (CVE-2009-2957, CVE-2009-2958)\n\n[2.48-3]\n- Use lzma compressed upstream tarball.\n\n[2.48-2]\n- Rebuilt for https://fedoraproject.org/wiki/Fedora_12_Mass_Rebuild\n\n[2.48-1]\n- Bugfix/feature enhancement update\n- Fixing BZ#494094\n\n[2.47-1]\n- Bugfix/feature enhancement update\n\n[2.46-2]\n- Rebuilt for https://fedoraproject.org/wiki/Fedora_11_Mass_Rebuild\n\n[2.45-2]\n- rebuilt\n\n[2.45-1]\n- Upstream release (bugfixes)\n\n[2.43-2]\n- New upstream release, contains fixes for CVE-2008-1447/CERT VU#800113\n- Dropped patch for newer glibc (merged upstream)\n\n[2.41-0.8]\n- Added upstream-authored patch for newer glibc (thanks Simon!)\n\n[2.41-0.7]\n- New upstream release\n\n[2.41-0.6.rc1]\n- Release candidate\n- Happy Birthday Isaac!\n\n[2.41-0.5.test30]\n- Bugfix update\n\n[2.41-0.4.test26]\n- Bugfix/feature enhancement update\n\n[2.41-0.3.test24]\n- Upstream fix for fairly serious regression\n\n[2.41-0.2.test20]\n- New upstream test release\n- Moving dnsmasq.leases to /var/lib/dnsmasq/ as per BZ#407901\n- Ignoring dangerous-command-in-%post rpmlint warning (as per above fix)\n- Patch consolidation/cleanup\n- Removed conditionals for Fedora <= 3 and Aurora 2.0\n\n[2.40-1]\n- Finalized upstream release\n- Removing URLs from patch lines (CVS is the authoritative source)\n- Added more magic to make spinning rc/test packages more seamless\n\n[2.40-0.1.rc2]\n- New upstream release candidate (feature-frozen), thanks Simon!\n- License clarification\n\n[2.39-1]\n- New upstream version (bugfixes, enhancements)\n\n[2.38-1]\n- New upstream version with bugfix for potential hang\n\n[2.37-1]\n- New upstream version\n\n[2.36-1]\n- New upstream version\n\n[2.35-2]\n- Stop creating /etc/sysconfig on %install\n- Create /etc/dnsmasq.d on %install\n\n[2.35-1]\n- Update to 2.35\n- Removed UPGRADING_to_2.0 from %doc as per upstream change\n- Enabled conf-dir in default config as per RFE BZ#214220 (thanks Chris!)\n- Added %dir /etc/dnsmasq.d to %files as per above RFE\n\n[2.34-2]\n- Fixed BZ#212005\n- Moved %postun scriptlet to %post, where it made more sense\n- Render scriptlets safer\n- Minor cleanup for consistency\n\n[2.34-1]\n- Hardcoded version in patches, as I'm getting tired of updating them\n- Update to 2.34\n\n[2.33-2]\n- Rebuild for FC6\n\n[2.33-1]\n- Update\n\n[2.32-3]\n- Added pkgconfig BuildReq due to reduced buildroot\n\n[2.32-2]\n- Forced update due to dbus version bump\n\n[2.32-1]\n- Update from upstream\n- Patch from Dennis Gilmore fixed the conditionals to detect Aurora Linux\n\n[2.31-1]\n- Removed dbus config patch (now provided upstream)\n- Patched in init script (no longer provided upstream)\n- Added DBus-interface to docs\n\n[2.30-4.2]\n- More upstream-recommended cleanups :)\n- Killed sysconfig file (provides unneeded functionality)\n- Tweaked init script a little more\n\n[2.30-4]\n- Moved options out of init script and into /etc/sysconfig/dnsmasq\n- Disabled DHCP_LEASE in sysconfig file, fixing bug #190379\n- Simon Kelley provided dbus/dnsmasq.conf, soon to be part of the tarball\n\n[2.30-3]\n- Un-enabled HAVE_ISC_READER, a hack to enable a deprecated feature (request)\n- Split initscript & enable-dbus patches, conditionalized dbus for FC3\n- Tweaked name field in changelog entries (trying to be consistent)\n\n[2.30-2]\n- Disabled stripping of binary while installing (oops)\n- Enabled HAVE_ISC_READER/HAVE_DBUS via patch\n- Added BuildReq for dbus-devel\n\n[2.30-1]\n- Initial Fedora Extras RPM\n",
		"advisory": {
			"severity": "IMPORTANT",
			"rights": "Copyright 2023 Oracle, Inc.",
			"issued": {
				"date": "2023-11-06"
			},
			"cve": [
				{
					"text": "CVE-2020-25681",
					"href": "https://linux-qa.oracle.com/cve/CVE-2020-25681.html"
				},
				{
					"text": "CVE-2020-25682",
					"href": "https://linux-qa.oracle.com/cve/CVE-2020-25682.html"
				}
			]
		}
	},
	"criteria": {
		"operator": "AND",
		"criterias": [
			{
				"operator": "AND",
				"criterias": [
					{
						"operator": "OR",
						"criterias": [
							{
								"operator": "AND",
								"criterions": [
									{
										"test_ref": "oval:com.oracle.elsa:tst:202312971003",
										"comment": "dnsmasq is earlier than 0:2.76-17.0.3.el7_9.3"
									},
									{
										"test_ref": "oval:com.oracle.elsa:tst:202312971004",
										"comment": "dnsmasq is signed with the Oracle Linux 7 key"
									}
								]
							},
							{
								"operator": "AND",
								"criterions": [
									{
										"test_ref": "oval:com.oracle.elsa:tst:202312971005",
										"comment": "dnsmasq-utils is earlier than 0:2.76-17.0.3.el7_9.3"
									},
									{
										"test_ref": "oval:com.oracle.elsa:tst:202312971006",
										"comment": "dnsmasq-utils is signed with the Oracle Linux 7 key"
									}
								]
							}
						]
					}
				],
				"criterions": [
					{
						"test_ref": "oval:com.oracle.elsa:tst:202312971002",
						"comment": "Oracle Linux arch is aarch64"
					}
				]
			}
		],
		"criterions": [
			{
				"test_ref": "oval:com.oracle.elsa:tst:202312971001",
				"comment": "Oracle Linux 7 is installed"
			}
		]
	}
}
